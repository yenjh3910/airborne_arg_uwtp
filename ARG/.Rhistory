"#BC80BD","#CCEBC5", # ARG type
"#FBB4AE","#B3CDE3","#CCEBC5" # sample type
)
graphics.off() # Reset figure window
circos.par(canvas.xlim = c(-0.5, 0.5), canvas.ylim = c(-1.5, 1))
chordDiagram(arg_circos, annotationTrack = "grid",
preAllocateTracks = 1, grid.col = grid.col,
directional = 1, big.gap = 10, scale = 0)
circos.trackPlotRegion(track.index = 1, panel.fun = function(x, y) {
xlim = get.cell.meta.data("xlim")
ylim = get.cell.meta.data("ylim")
sector.name = get.cell.meta.data("sector.index")
circos.text(cex = 0.8,mean(xlim), ylim[1] + .5, sector.name, facing = "clockwise", niceFacing = TRUE, adj = c(0, 0.5))
circos.axis(h = "top", labels.cex = 0.4, major.tick.percentage = 1, sector.index = sector.name, track.index = 2)
}, bg.border = NA)
graphics.off() # Reset figure window
circos.par(canvas.xlim = c(-0.5, 0.5), canvas.ylim = c(-1.5, 1))
chordDiagram(arg_circos, annotationTrack = "grid",
preAllocateTracks = 1, grid.col = grid.col,
directional = 1, big.gap = 10, scale = 0)
circos.track(track.index = 1, panel.fun = function(x, y) {
xlim = get.cell.meta.data("xlim")
ylim = get.cell.meta.data("ylim")
sector.name = get.cell.meta.data("sector.index")
xplot = get.cell.meta.data("xplot")
circos.lines(xlim, c(mean(ylim), mean(ylim)), lty = 3) # dotted line
by = ifelse(abs(xplot[2] - xplot[1]) > 30, 0.2, 0.5)
for(p in seq(by, 1, by = by)) {
circos.text(p*(xlim[2] - xlim[1]) + xlim[1], mean(ylim) + 0.1,
paste0(p*100, "%"), cex = 0.3, adj = c(0.5, 0), niceFacing = TRUE)
}
circos.text(mean(xlim), 1, sector.name, niceFacing = TRUE, adj = c(0.5, 0))
}, bg.border = NA)
graphics.off() # Reset figure window
circos.par(canvas.xlim = c(-0.5, 0.5), canvas.ylim = c(-1.5, 1))
chordDiagram(arg_circos, annotationTrack = "grid",
preAllocateTracks = 1, grid.col = grid.col,
directional = 1, big.gap = 10, scale = 0)
for(si in get.all.sector.index()) {
circos.axis(h = "top", labels.cex = 0.3, sector.index = si, track.index = 2)
}
circos.track(track.index = 1, panel.fun = function(x, y) {
xlim = get.cell.meta.data("xlim")
ylim = get.cell.meta.data("ylim")
sector.name = get.cell.meta.data("sector.index")
xplot = get.cell.meta.data("xplot")
circos.lines(xlim, c(mean(ylim), mean(ylim)), lty = 3) # dotted line
by = ifelse(abs(xplot[2] - xplot[1]) > 30, 0.2, 0.5)
for(p in seq(by, 1, by = by)) {
circos.text(p*(xlim[2] - xlim[1]) + xlim[1], mean(ylim) + 0.1,
paste0(p*100, "%"), cex = 0.3, adj = c(0.5, 0), niceFacing = TRUE)
}
circos.text(mean(xlim), 1, sector.name, niceFacing = TRUE, adj = c(0.5, 0))
}, bg.border = NA)
circos.text(h = "top"ㄝmean(xlim), 1, sector.name, niceFacing = TRUE, adj = c(0.5, 0))
circos.track(track.index = 1, panel.fun = function(x, y) {
xlim = get.cell.meta.data("xlim")
ylim = get.cell.meta.data("ylim")
sector.name = get.cell.meta.data("sector.index")
xplot = get.cell.meta.data("xplot")
circos.lines(xlim, c(mean(ylim), mean(ylim)), lty = 3) # dotted line
by = ifelse(abs(xplot[2] - xplot[1]) > 30, 0.2, 0.5)
for(p in seq(by, 1, by = by)) {
circos.text(p*(xlim[2] - xlim[1]) + xlim[1], mean(ylim) + 0.1,
paste0(p*100, "%"), cex = 0.3, adj = c(0.5, 0), niceFacing = TRUE)
}
circos.text(h = "top"ㄝmean(xlim), 1, sector.name, niceFacing = TRUE, adj = c(0.5, 0))
}, bg.border = NA)
graphics.off() # Reset figure window
circos.par(canvas.xlim = c(-0.5, 0.5), canvas.ylim = c(-1.5, 1))
chordDiagram(arg_circos, annotationTrack = "grid",
preAllocateTracks = 1, grid.col = grid.col,
directional = 1, big.gap = 10, scale = 0)
for(si in get.all.sector.index()) {
circos.axis(h = "top", labels.cex = 0.3, sector.index = si, track.index = 2)
}
circos.track(track.index = 1, panel.fun = function(x, y) {
xlim = get.cell.meta.data("xlim")
ylim = get.cell.meta.data("ylim")
sector.name = get.cell.meta.data("sector.index")
xplot = get.cell.meta.data("xplot")
circos.lines(xlim, c(mean(ylim), mean(ylim)), lty = 3) # dotted line
by = ifelse(abs(xplot[2] - xplot[1]) > 30, 0.2, 0.5)
for(p in seq(by, 1, by = by)) {
circos.text(p*(xlim[2] - xlim[1]) + xlim[1], mean(ylim) + 0.1,
paste0(p*100, "%"), cex = 0.3, adj = c(0.5, 0), niceFacing = TRUE)
}
circos.text(h = "top"ㄝmean(xlim), 1, sector.name, niceFacing = TRUE, adj = c(0.5, 0))
}, bg.border = NA)
circos.trackPlotRegion(track.index = 1,
panel.fun = function(x, y) {
xlim = get.cell.meta.data("xlim")
ylim = get.cell.meta.data("ylim")
sector.name = get.cell.meta.data("sector.index")
circos.text(cex = 0.8,mean(xlim), ylim[1] + .5, sector.name, facing = "clockwise", niceFacing = TRUE, adj = c(0, 0.5))
circos.axis(h = "top", labels.cex = 0.4, major.tick.percentage = 1, sector.index = sector.name, track.index = 2)
}, bg.border = NA)
graphics.off() # Reset figure window
circos.par(canvas.xlim = c(-0.5, 0.5), canvas.ylim = c(-1.5, 1))
chordDiagram(arg_circos, annotationTrack = "grid",
preAllocateTracks = 1, grid.col = grid.col,
directional = 1, big.gap = 10, scale = 0)
for(si in get.all.sector.index()) {
circos.axis(h = "top", labels.cex = 0.3, sector.index = si, track.index = 2)
}
circos.track(track.index = 1, panel.fun = function(x, y) {
xlim = get.cell.meta.data("xlim")
ylim = get.cell.meta.data("ylim")
sector.name = get.cell.meta.data("sector.index")
xplot = get.cell.meta.data("xplot")
circos.lines(xlim, c(mean(ylim), mean(ylim)), lty = 3) # dotted line
by = ifelse(abs(xplot[2] - xplot[1]) > 30, 0.2, 0.5)
for(p in seq(by, 1, by = by)) {
circos.text(p*(xlim[2] - xlim[1]) + xlim[1], mean(ylim) + 0.1,
paste0(p*100, "%"), cex = 0.3, adj = c(0.5, 0), niceFacing = TRUE)
}
circos.text(h = "top"ㄝmean(xlim), 1, sector.name, niceFacing = TRUE, adj = c(0.5, 0))
}, bg.border = NA)
circos.track(track.index = 1, panel.fun = function(x, y) {
xlim = get.cell.meta.data("xlim")
ylim = get.cell.meta.data("ylim")
sector.name = get.cell.meta.data("sector.index")
xplot = get.cell.meta.data("xplot")
circos.lines(xlim, c(mean(ylim), mean(ylim)), lty = 3) # dotted line
by = ifelse(abs(xplot[2] - xplot[1]) > 30, 0.2, 0.5)
for(p in seq(by, 1, by = by)) {
circos.text(p*(xlim[2] - xlim[1]) + xlim[1], mean(ylim) + 0.1,
paste0(p*100, "%"), cex = 0.3, adj = c(0.5, 0), niceFacing = TRUE)
}
circos.text(mean(xlim), 1, sector.name, niceFacing = TRUE, adj = c(0.5, 0))
}, bg.border = NA)
graphics.off() # Reset figure window
circos.par(canvas.xlim = c(-0.5, 0.5), canvas.ylim = c(-1.5, 1))
chordDiagram(arg_circos, annotationTrack = "grid",
preAllocateTracks = 1, grid.col = grid.col,
directional = 1, big.gap = 10, scale = 0)
for(si in get.all.sector.index()) {
circos.axis(h = "top", labels.cex = 0.3, sector.index = si, track.index = 2)
}
circos.track(track.index = 1, panel.fun = function(x, y) {
xlim = get.cell.meta.data("xlim")
ylim = get.cell.meta.data("ylim")
sector.name = get.cell.meta.data("sector.index")
xplot = get.cell.meta.data("xplot")
circos.lines(xlim, c(mean(ylim), mean(ylim)), lty = 3) # dotted line
by = ifelse(abs(xplot[2] - xplot[1]) > 30, 0.2, 0.5)
for(p in seq(by, 1, by = by)) {
circos.text(p*(xlim[2] - xlim[1]) + xlim[1], mean(ylim) + 0.1,
paste0(p*100, "%"), cex = 0.3, adj = c(0.5, 0), niceFacing = TRUE)
}
circos.text(h = "top",mean(xlim), 1, sector.name, niceFacing = TRUE, adj = c(0.5, 0))
}, bg.border = NA)
circos.text(p*(xlim[2] - xlim[1]) + xlim[1], mean(ylim) + 0.1, facing = "clockwise",
paste0(p*100, "%"), cex = 0.3, adj = c(0.5, 0), niceFacing = TRUE)
graphics.off() # Reset figure window
circos.par(canvas.xlim = c(-0.5, 0.5), canvas.ylim = c(-1.5, 1))
chordDiagram(arg_circos, annotationTrack = "grid",
preAllocateTracks = 1, grid.col = grid.col,
directional = 1, big.gap = 10, scale = 0)
for(si in get.all.sector.index()) {
circos.axis(h = "top", labels.cex = 0.3, sector.index = si, track.index = 2)
}
circos.track(track.index = 1, panel.fun = function(x, y) {
xlim = get.cell.meta.data("xlim")
ylim = get.cell.meta.data("ylim")
sector.name = get.cell.meta.data("sector.index")
xplot = get.cell.meta.data("xplot")
circos.lines(xlim, c(mean(ylim), mean(ylim)), lty = 3) # dotted line
by = ifelse(abs(xplot[2] - xplot[1]) > 30, 0.2, 0.5)
for(p in seq(by, 1, by = by)) {
circos.text(p*(xlim[2] - xlim[1]) + xlim[1], mean(ylim) + 0.1, facing = "clockwise",
paste0(p*100, "%"), cex = 0.3, adj = c(0.5, 0), niceFacing = TRUE)
}
circos.text(mean(xlim), 1, sector.name, niceFacing = TRUE, adj = c(0.5, 0))
}, bg.border = NA)
graphics.off() # Reset figure window
circos.par(canvas.xlim = c(-0.5, 0.5), canvas.ylim = c(-1.5, 1))
chordDiagram(arg_circos, annotationTrack = "grid",
preAllocateTracks = 1, grid.col = grid.col,
directional = 1, big.gap = 10, scale = 0)
for(si in get.all.sector.index()) {
circos.axis(h = "top", labels.cex = 0.3, sector.index = si, track.index = 2)
}
circos.track(track.index = 1, panel.fun = function(x, y) {
xlim = get.cell.meta.data("xlim")
ylim = get.cell.meta.data("ylim")
sector.name = get.cell.meta.data("sector.index")
xplot = get.cell.meta.data("xplot")
circos.lines(xlim, c(mean(ylim), mean(ylim)), lty = 4) # dotted line
by = ifelse(abs(xplot[2] - xplot[1]) > 30, 0.2, 0.5)
for(p in seq(by, 1, by = by)) {
circos.text(p*(xlim[2] - xlim[1]) + xlim[1], mean(ylim) + 0.1, facing = "clockwise",
paste0(p*100, "%"), cex = 0.3, adj = c(0.5, 0), niceFacing = TRUE)
}
circos.text(mean(xlim), 1, sector.name, niceFacing = TRUE, adj = c(0.5, 0))
}, bg.border = NA)
circos.track(track.index = 1, panel.fun = function(x, y) {
xlim = get.cell.meta.data("xlim")
ylim = get.cell.meta.data("ylim")
sector.name = get.cell.meta.data("sector.index")
xplot = get.cell.meta.data("xplot")
circos.lines(xlim, c(mean(ylim), mean(ylim)), lty = 1) # dotted line
by = ifelse(abs(xplot[2] - xplot[1]) > 30, 0.2, 0.5)
for(p in seq(by, 1, by = by)) {
circos.text(p*(xlim[2] - xlim[1]) + xlim[1], mean(ylim) + 0.1, facing = "clockwise",
paste0(p*100, "%"), cex = 0.3, adj = c(0.5, 0), niceFacing = TRUE)
}
circos.text(mean(xlim), 1, sector.name, niceFacing = TRUE, adj = c(0.5, 0))
}, bg.border = NA)
graphics.off() # Reset figure window
circos.par(canvas.xlim = c(-0.5, 0.5), canvas.ylim = c(-1.5, 1))
chordDiagram(arg_circos, annotationTrack = "grid",
preAllocateTracks = 1, grid.col = grid.col,
directional = 1, big.gap = 10, scale = 0)
for(si in get.all.sector.index()) {
circos.axis(h = "top", labels.cex = 0.3, sector.index = si, track.index = 2)
}
circos.track(track.index = 1, panel.fun = function(x, y) {
xlim = get.cell.meta.data("xlim")
ylim = get.cell.meta.data("ylim")
sector.name = get.cell.meta.data("sector.index")
xplot = get.cell.meta.data("xplot")
circos.lines(xlim, c(mean(ylim), mean(ylim)), lty = 2) # dotted line
by = ifelse(abs(xplot[2] - xplot[1]) > 30, 0.2, 0.5)
for(p in seq(by, 1, by = by)) {
circos.text(p*(xlim[2] - xlim[1]) + xlim[1], mean(ylim) + 0.1, facing = "clockwise",
paste0(p*100, "%"), cex = 0.3, adj = c(0.5, 0), niceFacing = TRUE)
}
circos.text(mean(xlim), 1, sector.name, niceFacing = TRUE, adj = c(0.5, 0))
}, bg.border = NA)
circos.lines(xlim, c(mean(ylim), mean(ylim)), lty = 5) # dotted line
graphics.off() # Reset figure window
circos.par(canvas.xlim = c(-0.5, 0.5), canvas.ylim = c(-1.5, 1))
chordDiagram(arg_circos, annotationTrack = "grid",
preAllocateTracks = 1, grid.col = grid.col,
directional = 1, big.gap = 10, scale = 0)
for(si in get.all.sector.index()) {
circos.axis(h = "top", labels.cex = 0.3, sector.index = si, track.index = 2)
}
circos.track(track.index = 1, panel.fun = function(x, y) {
xlim = get.cell.meta.data("xlim")
ylim = get.cell.meta.data("ylim")
sector.name = get.cell.meta.data("sector.index")
xplot = get.cell.meta.data("xplot")
circos.lines(xlim, c(mean(ylim), mean(ylim)), lty = 5) # dotted line
by = ifelse(abs(xplot[2] - xplot[1]) > 30, 0.2, 0.5)
for(p in seq(by, 1, by = by)) {
circos.text(p*(xlim[2] - xlim[1]) + xlim[1], mean(ylim) + 0.1, facing = "clockwise",
paste0(p*100, "%"), cex = 0.3, adj = c(0.5, 0), niceFacing = TRUE)
}
circos.text(mean(xlim), 1, sector.name, niceFacing = TRUE, adj = c(0.5, 0))
}, bg.border = NA)
graphics.off() # Reset figure window
circos.par(canvas.xlim = c(-0.5, 0.5), canvas.ylim = c(-1.5, 1))
chordDiagram(arg_circos, annotationTrack = "grid",
preAllocateTracks = 1, grid.col = grid.col,
directional = 1, big.gap = 10, scale = 0)
for(si in get.all.sector.index()) {
circos.axis(h = "top", labels.cex = 0.3, sector.index = si, track.index = 2)
}
circos.track(track.index = 1, panel.fun = function(x, y) {
xlim = get.cell.meta.data("xlim")
ylim = get.cell.meta.data("ylim")
sector.name = get.cell.meta.data("sector.index")
xplot = get.cell.meta.data("xplot")
circos.lines(xlim, c(mean(ylim), mean(ylim)), lty = 6) # dotted line
by = ifelse(abs(xplot[2] - xplot[1]) > 30, 0.2, 0.5)
for(p in seq(by, 1, by = by)) {
circos.text(p*(xlim[2] - xlim[1]) + xlim[1], mean(ylim) + 0.1, facing = "clockwise",
paste0(p*100, "%"), cex = 0.3, adj = c(0.5, 0), niceFacing = TRUE)
}
circos.text(mean(xlim), 1, sector.name, niceFacing = TRUE, adj = c(0.5, 0))
}, bg.border = NA)
graphics.off() # Reset figure window
circos.par(canvas.xlim = c(-0.5, 0.5), canvas.ylim = c(-1.5, 1))
chordDiagram(arg_circos, annotationTrack = "grid",
preAllocateTracks = 1, grid.col = grid.col,
directional = 1, big.gap = 10, scale = 0)
for(si in get.all.sector.index()) {
circos.axis(h = "top", labels.cex = 0.3, sector.index = si, track.index = 2)
}
circos.track(track.index = 1, panel.fun = function(x, y) {
xlim = get.cell.meta.data("xlim")
ylim = get.cell.meta.data("ylim")
sector.name = get.cell.meta.data("sector.index")
xplot = get.cell.meta.data("xplot")
circos.lines(xlim, c(mean(ylim), mean(ylim)), lty = 1) # dotted line
by = ifelse(abs(xplot[2] - xplot[1]) > 30, 0.2, 0.5)
for(p in seq(by, 1, by = by)) {
circos.text(p*(xlim[2] - xlim[1]) + xlim[1], mean(ylim) + 0.1, facing = "clockwise",
paste0(p*100, "%"), cex = 0.3, adj = c(0.5, 0), niceFacing = TRUE)
}
circos.text(mean(xlim), 1, sector.name, niceFacing = TRUE, adj = c(0.5, 0))
}, bg.border = NA)
graphics.off() # Reset figure window
circos.par(canvas.xlim = c(-0.5, 0.5), canvas.ylim = c(-1.5, 1))
chordDiagram(arg_circos, annotationTrack = "grid",
preAllocateTracks = 1, grid.col = grid.col,
directional = 1, big.gap = 10, scale = 0)
circos.trackPlotRegion(track.index = 1,
panel.fun = function(x, y) {
xlim = get.cell.meta.data("xlim")
ylim = get.cell.meta.data("ylim")
sector.name = get.cell.meta.data("sector.index")
circos.text(cex = 0.8,mean(xlim), ylim[1] + .5, sector.name, facing = "clockwise", niceFacing = TRUE, adj = c(0, 0.5))
circos.axis(h = "top", labels.cex = 0.4, major.tick.percentage = 1, sector.index = sector.name, track.index = 2)
}, bg.border = NA)
graphics.off() # Reset figure window
# Save
pdf("../../airborne_arg_uwtp_result/Figure/ARG/ARG_circos.pdf")
graphics.off() # Reset figure window
circos.par(canvas.xlim = c(-0.5, 0.5), canvas.ylim = c(-1.5, 1))
chordDiagram(arg_circos, annotationTrack = "grid",
preAllocateTracks = 1, grid.col = grid.col,
directional = 1, big.gap = 10, scale = 0)
for(si in get.all.sector.index()) {
circos.axis(h = "top", labels.cex = 0.3, sector.index = si, track.index = 2)
}
graphics.off() # Reset figure window
# Save
pdf("../../airborne_arg_uwtp_result/Figure/ARG/ARG_circos.pdf")
graphics.off() # Reset figure window
circos.par(canvas.xlim = c(-0.5, 0.5), canvas.ylim = c(-1.5, 1))
chordDiagram(arg_circos, annotationTrack = "grid",
preAllocateTracks = 1, grid.col = grid.col,
directional = 1, big.gap = 10, scale = 0)
circos.trackPlotRegion(track.index = 1,
panel.fun = function(x, y) {
xlim = get.cell.meta.data("xlim")
ylim = get.cell.meta.data("ylim")
sector.name = get.cell.meta.data("sector.index")
circos.text(cex = 0.8,mean(xlim), ylim[1] + .5, sector.name, facing = "clockwise", niceFacing = TRUE, adj = c(0, 0.5))
circos.axis(h = "top", labels.cex = 0.4, major.tick.percentage = 1, sector.index = sector.name, track.index = 2)
}, bg.border = NA)
dev.off()
dev.off()
# Save
pdf("../../airborne_arg_uwtp_result/Figure/ARG/ARG_circos.pdf")
graphics.off() # Reset figure window
circos.par(canvas.xlim = c(-0.5, 0.5), canvas.ylim = c(-1.5, 1))
chordDiagram(arg_circos, annotationTrack = "grid",
preAllocateTracks = 1, grid.col = grid.col,
directional = 1, big.gap = 10, scale = 0)
circos.trackPlotRegion(track.index = 1,
panel.fun = function(x, y) {
xlim = get.cell.meta.data("xlim")
ylim = get.cell.meta.data("ylim")
sector.name = get.cell.meta.data("sector.index")
circos.text(cex = 0.8,mean(xlim), ylim[1] + .5, sector.name, facing = "clockwise", niceFacing = TRUE, adj = c(0, 0.5))
circos.axis(h = "top", labels.cex = 0.4, major.tick.percentage = 1, sector.index = sector.name, track.index = 2)
}, bg.border = NA)
dev.off()
graphics.off() # Reset figure window
dev.off()
# Save
pdf("../../airborne_arg_uwtp_result/Figure/ARG/ARG_circos.pdf")
circos.par(canvas.xlim = c(-0.5, 0.5), canvas.ylim = c(-1.5, 1))
chordDiagram(arg_circos, annotationTrack = "grid",
preAllocateTracks = 1, grid.col = grid.col,
directional = 1, big.gap = 10, scale = 0)
circos.trackPlotRegion(track.index = 1,
panel.fun = function(x, y) {
xlim = get.cell.meta.data("xlim")
ylim = get.cell.meta.data("ylim")
sector.name = get.cell.meta.data("sector.index")
circos.text(cex = 0.8,mean(xlim), ylim[1] + .5, sector.name, facing = "clockwise", niceFacing = TRUE, adj = c(0, 0.5))
circos.axis(h = "top", labels.cex = 0.4, major.tick.percentage = 1, sector.index = sector.name, track.index = 2)
}, bg.border = NA)
dev.off()
# ARG_type_circos.R
# Import library
library(tidyverse)
library(circlize)
library(RColorBrewer)
# Read ARG_type file
arg_type <- read.table("../../airborne_arg_uwtp_result/args_oap/ARG/stage_two_output/normalized_cell.type.txt",
header = TRUE, sep = "")
# gather df
gather_arg_type <- gather(arg_type, key = "sample", value = "copy_per_cell",
ARP1:ODP5) # Transform to gather format
# Add sample type column
gather_arg_type$sample_type <- gather_arg_type$sample
gather_arg_type$sample_type <- gsub("1|2|3|4|5","",gather_arg_type$sample_type)
# Calculate average abundance per sample type
gather_arg_type <- gather_arg_type %>% group_by(type, sample_type) %>%
mutate(mean = mean(copy_per_cell)) %>%
select(!(sample)) %>%
select(!(copy_per_cell)) %>%
unique()
# Calculate mean value and order of ARG type in all sample
average_arg <- gather_arg_type %>% group_by(type) %>% summarize(average =  mean(mean))
arg_order <- average_arg[order(average_arg$average, decreasing = T),]$type
# Spread df
arg_circos <- gather_arg_type %>% spread(key = sample_type, value = mean)
# Order ARG type
arg_circos <- arg_circos %>%
arrange(factor(type, levels = arg_order))
# Convert to dataframe
arg_circos <- as.data.frame(arg_circos)
# First column as row name
row.names(arg_circos) <- arg_circos$type
arg_circos <- arg_circos[,-1]
# Convert to matrix
arg_circos<- as.matrix(arg_circos)
# Calculate others ARG type
Others <- colSums(arg_circos[11:26, ])
arg_circos <- rbind(arg_circos, Others)
# Delete minimum arg type
arg_circos <- arg_circos[-(11:26),]
# Covert first letter to uppercase
rownames(arg_circos) <- str_to_title(rownames(arg_circos))
# Change specific ARG type
row.names(arg_circos)[3] <- "MLS"
row.names(arg_circos)[6] <- "Beta-lactam"
# Change column order
arg_circos <- arg_circos[, c("AT", "ARP", "ODP")]
# # Convert abundance to relative abundance
# arg_circos <- apply(arg_circos,-1, function(x) x/sum(x))
# Set color
display.brewer.all()
brewer.pal(n=6,name="Set2")
grid.col = c("#8DD3C7","#FFFFB3","#BEBADA",
"#FB8072","#80B1D3","#FDB462",
"#B3DE69","#FCCDE5","#D9D9D9",
"#BC80BD","#CCEBC5", # ARG type
"#FBB4AE","#B3CDE3","#CCEBC5" # sample type
)
# Save
# pdf("../../airborne_arg_uwtp_result/Figure/ARG/ARG_circos.pdf")
graphics.off() # Reset figure window
circos.par(canvas.xlim = c(-0.5, 0.5), canvas.ylim = c(-1.5, 1))
chordDiagram(arg_circos, annotationTrack = "grid",
preAllocateTracks = 1, grid.col = grid.col,
directional = 1, big.gap = 10, scale = 0)
circos.trackPlotRegion(track.index = 1,
panel.fun = function(x, y) {
xlim = get.cell.meta.data("xlim")
ylim = get.cell.meta.data("ylim")
sector.name = get.cell.meta.data("sector.index")
circos.text(cex = 0.8,mean(xlim), ylim[1] + .5, sector.name, facing = "clockwise", niceFacing = TRUE, adj = c(0, 0.5))
circos.axis(h = "top", labels.cex = 0.4, major.tick.percentage = 1, sector.index = sector.name, track.index = 2)
}, bg.border = NA)
View(arg_circos)
highlight.sector(rownames(mat1), track.index = 1, col = "#FF856580",
text = "A", cex = 0.8, text.col = "black", border = "black",niceFacing = TRUE)
highlight.sector(rownames(arg_circos), track.index = 1, col = "#FF856580",
text = "A", cex = 0.8, text.col = "black", border = "black",niceFacing = TRUE)
highlight.sector(rownames(arg_circos), track.index = 1, col = "#FF856580",
text = "B", cex = 0.8, text.col = "black", border = "black",niceFacing = TRUE)
# Save
# pdf("../../airborne_arg_uwtp_result/Figure/ARG/ARG_circos.pdf")
graphics.off() # Reset figure window
circos.par(canvas.xlim = c(-0.5, 0.5), canvas.ylim = c(-1.5, 1))
chordDiagram(arg_circos, annotationTrack = "grid",
preAllocateTracks = 1, grid.col = grid.col,
directional = 1, big.gap = 10, scale = 0)
circos.trackPlotRegion(track.index = 1,
panel.fun = function(x, y) {
xlim = get.cell.meta.data("xlim")
ylim = get.cell.meta.data("ylim")
sector.name = get.cell.meta.data("sector.index")
circos.text(cex = 0.8,mean(xlim), ylim[1] + .5, sector.name, facing = "clockwise", niceFacing = TRUE, adj = c(0, 0.5))
circos.axis(h = "top", labels.cex = 0.4, major.tick.percentage = 1, sector.index = sector.name, track.index = 2)
}, bg.border = NA)
highlight.sector(rownames(arg_circos), track.index = 1, col = "#FF856580",
text = "A", cex = 0.8, text.col = "black", border = "black",niceFacing = TRUE)
highlight.sector(colnames(arg_circos), track.index = 1, col = "#FF856580",
text = "B", cex = 0.8, text.col = "black", border = "black",niceFacing = TRUE)
# Save
# pdf("../../airborne_arg_uwtp_result/Figure/ARG/ARG_circos.pdf")
graphics.off() # Reset figure window
circos.par(canvas.xlim = c(-0.5, 0.5), canvas.ylim = c(-1.5, 1))
chordDiagram(arg_circos, annotationTrack = "grid",
preAllocateTracks = 1, grid.col = grid.col,
directional = 1, big.gap = 10, scale = 0)
circos.trackPlotRegion(track.index = 1,
panel.fun = function(x, y) {
xlim = get.cell.meta.data("xlim")
ylim = get.cell.meta.data("ylim")
sector.name = get.cell.meta.data("sector.index")
circos.text(cex = 0.8,mean(xlim), ylim[1] + .5, sector.name, facing = "clockwise", niceFacing = TRUE, adj = c(0, 0.5))
circos.axis(h = "top", labels.cex = 0.4, major.tick.percentage = 1, sector.index = sector.name, track.index = 2)
}, bg.border = NA)
highlight.sector(rownames(arg_circos), track.index = 1, col = "#FF856580",
text = "A", cex = 0.1, text.col = "black", border = "black",niceFacing = TRUE)
highlight.sector(colnames(arg_circos), track.index = 1, col = "#FF856580",
text = "B", cex = 0.8, text.col = "black", border = "black",niceFacing = TRUE)
# Save
# pdf("../../airborne_arg_uwtp_result/Figure/ARG/ARG_circos.pdf")
graphics.off() # Reset figure window
circos.par(canvas.xlim = c(-0.5, 0.5), canvas.ylim = c(-1.5, 1))
chordDiagram(arg_circos, annotationTrack = "grid",
preAllocateTracks = 1, grid.col = grid.col,
directional = 1, big.gap = 10, scale = 0)
circos.trackPlotRegion(track.index = 1,
panel.fun = function(x, y) {
xlim = get.cell.meta.data("xlim")
ylim = get.cell.meta.data("ylim")
sector.name = get.cell.meta.data("sector.index")
circos.text(cex = 0.8,mean(xlim), ylim[1] + .5, sector.name, facing = "clockwise", niceFacing = TRUE, adj = c(0, 0.5))
circos.axis(h = "top", labels.cex = 0.4, major.tick.percentage = 1, sector.index = sector.name, track.index = 2)
}, bg.border = NA)
highlight.sector(rownames(arg_circos), track.index = 2, col = "#FF856580",
text = "A", cex = 0.8, text.col = "black", border = "black",niceFacing = TRUE)
highlight.sector(rownames(arg_circos), track.index = 3, col = "#FF856580",
text = "A", cex = 0.8, text.col = "black", border = "black",niceFacing = TRUE)
highlight.sector(rownames(arg_circos), track.index = 1, col = "#FF856580",
text = "A", cex = 0.8, text.col = "black", border = "black",niceFacing = TRUE)
highlight.sector(rownames(arg_circos), track.index = 0, col = "#FF856580",
text = "A", cex = 0.8, text.col = "black", border = "black",niceFacing = TRUE)
highlight.sector(rownames(arg_circos), track.index = -1, col = "#FF856580",
text = "A", cex = 0.8, text.col = "black", border = "black",niceFacing = TRUE)
