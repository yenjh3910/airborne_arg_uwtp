dev.off()
# Plot
## Save
pdf(file= "../../airborne_arg_uwtp_result/Figure/ARG/ARG_upset.pdf",
width = 8,
height = 6)
upset(fromList(arg_subtype),
nsets = 15,
nintersects = 52,
order.by = "freq",
mb.ratio = c(0.6,0.4),   # 左侧和上方条形图的比例关系
text.scale = 1.5,
mainbar.y.label = "Intersection ARG subtype numbers",
sets.x.label = "ARG subtype numbers",
main.bar.color = "#f4cccc", matrix.color = "#A6CEE3",
sets.bar.color = "#A6CEE3",
shade.color = "#A6CEE3",
shade.alpha = 0.25, matrix.dot.alpha = 0.5,
queries = list(
list(
query = intersects,
params = list("AT1","AT2","AT3","AT4","AT5",
"ARP1","ARP2","ARP3","ARP4","ARP5",
"ODP1","ODP2","ODP3","ODP4","ODP5"),
color = "#FB8072",active = T),
list(
query = intersects,
params = list("AT1","AT2","AT3","AT4","AT5",
"ARP1","ARP2","ARP3","ARP4","ARP5"),
color = "#FB8072",active = T),
list(
query = intersects,
params = list("AT1","AT2","AT3","AT4","AT5",
"ARP1","ARP2","ARP3","ARP4","ARP5",
"ODP1","ODP2","ODP4","ODP5"),
color = "#FB8072",active = T),
list(
query = intersects,
params = list("AT1","AT2","AT3","AT4","AT5",
"ARP1","ARP2","ARP3","ARP4","ARP5",
"ODP2","ODP3","ODP4","ODP5"),
color = "#FB8072",active = T),
list(
query = intersects,
params = list("AT1","AT2","AT3","AT4","AT5",
"ARP1","ARP2","ARP3","ARP4","ARP5",
"ODP4"),
color = "#FB8072",active = T),
list(
query = intersects,
params = list("AT1","AT2","AT3","AT4","AT5",
"ARP1","ARP2","ARP3","ARP4","ARP5",
"ODP1","ODP3","ODP4","ODP5"),
color = "#FB8072",active = T),
list(
query = intersects,
params = list("AT1","AT2","AT3","AT4","AT5",
"ARP1","ARP2","ARP3","ARP4"),
color = "#FB8072",active = T),
list(
query = intersects,
params = list("AT1","AT2","AT3","AT4","AT5",
"ARP3","ARP4","ARP5"),
color = "#FB8072",active = T),
list(
query = intersects,
params = list("AT1","AT2","AT3","AT4","AT5",
"ARP1","ARP2","ARP3","ARP4","ARP5",
"ODP2","ODP5"),
color = "#FB8072",active = T),
list(
query = intersects,
params = list("AT1","AT2","AT3","AT4","AT5",
"ARP1","ARP2","ARP3","ARP4","ARP5",
"ODP2","ODP3","ODP4"),
color = "#FB8072",active = T),
list(
query = intersects,
params = list("AT1","AT2","AT3","AT4","AT5",
"ARP1","ARP3","ARP4","ARP5"),
color = "#FB8072",active = T),
list(
query = intersects,
params = list("AT1","AT2","AT3","AT4","AT5",
"ARP1","ARP2","ARP3","ARP4","ARP5",
"ODP3"),
color = "#FB8072",active = T),
list(
query = intersects,
params = list("AT1","AT2","AT3","AT4","AT5",
"ARP1","ARP2","ARP3","ARP4","ARP5",
"ODP4","ODP5"),
color = "#FB8072",active = T),
list(
query = intersects,
params = list("AT2",
"ARP1"),
color = "#FB8072",active = T),
list(
query = intersects,
params = list("AT4",
"ARP5"),
color = "#FB8072",active = T),
list(
query = intersects,
params = list("AT1","AT2","AT3","AT4","AT5",
"ARP1","ARP2","ARP3","ARP5",
"ODP5"),
color = "#FB8072",active = T),
list(
query = intersects,
params = list("AT1","AT2","AT3","AT4","AT5",
"ARP1","ARP2","ARP3","ARP4","ARP5",
"ODP1"),
color = "#FB8072",active = T),
list(
query = intersects,
params = list("AT1","AT2","AT3","AT4","AT5",
"ARP1","ARP2","ARP3","ARP4","ARP5",
"ODP2"),
color = "#FB8072",active = T),
list(
query = intersects,
params = list("AT1","AT2","AT3","AT4","AT5",
"ARP1","ARP2","ARP3","ARP4","ARP5",
"ODP5"),
color = "#FB8072",active = T)
)
)
dev.off()
# Plot
## Save
pdf(file= "../../airborne_arg_uwtp_result/Figure/ARG/ARG_upset.pdf",
width = 9,
height = 6)
upset(fromList(arg_subtype),
nsets = 15,
nintersects = 52,
order.by = "freq",
mb.ratio = c(0.6,0.4),   # 左侧和上方条形图的比例关系
text.scale = 1.5,
mainbar.y.label = "Intersection ARG subtype numbers",
sets.x.label = "ARG subtype numbers",
main.bar.color = "#f4cccc", matrix.color = "#A6CEE3",
sets.bar.color = "#A6CEE3",
shade.color = "#A6CEE3",
shade.alpha = 0.25, matrix.dot.alpha = 0.5,
queries = list(
list(
query = intersects,
params = list("AT1","AT2","AT3","AT4","AT5",
"ARP1","ARP2","ARP3","ARP4","ARP5",
"ODP1","ODP2","ODP3","ODP4","ODP5"),
color = "#FB8072",active = T),
list(
query = intersects,
params = list("AT1","AT2","AT3","AT4","AT5",
"ARP1","ARP2","ARP3","ARP4","ARP5"),
color = "#FB8072",active = T),
list(
query = intersects,
params = list("AT1","AT2","AT3","AT4","AT5",
"ARP1","ARP2","ARP3","ARP4","ARP5",
"ODP1","ODP2","ODP4","ODP5"),
color = "#FB8072",active = T),
list(
query = intersects,
params = list("AT1","AT2","AT3","AT4","AT5",
"ARP1","ARP2","ARP3","ARP4","ARP5",
"ODP2","ODP3","ODP4","ODP5"),
color = "#FB8072",active = T),
list(
query = intersects,
params = list("AT1","AT2","AT3","AT4","AT5",
"ARP1","ARP2","ARP3","ARP4","ARP5",
"ODP4"),
color = "#FB8072",active = T),
list(
query = intersects,
params = list("AT1","AT2","AT3","AT4","AT5",
"ARP1","ARP2","ARP3","ARP4","ARP5",
"ODP1","ODP3","ODP4","ODP5"),
color = "#FB8072",active = T),
list(
query = intersects,
params = list("AT1","AT2","AT3","AT4","AT5",
"ARP1","ARP2","ARP3","ARP4"),
color = "#FB8072",active = T),
list(
query = intersects,
params = list("AT1","AT2","AT3","AT4","AT5",
"ARP3","ARP4","ARP5"),
color = "#FB8072",active = T),
list(
query = intersects,
params = list("AT1","AT2","AT3","AT4","AT5",
"ARP1","ARP2","ARP3","ARP4","ARP5",
"ODP2","ODP5"),
color = "#FB8072",active = T),
list(
query = intersects,
params = list("AT1","AT2","AT3","AT4","AT5",
"ARP1","ARP2","ARP3","ARP4","ARP5",
"ODP2","ODP3","ODP4"),
color = "#FB8072",active = T),
list(
query = intersects,
params = list("AT1","AT2","AT3","AT4","AT5",
"ARP1","ARP3","ARP4","ARP5"),
color = "#FB8072",active = T),
list(
query = intersects,
params = list("AT1","AT2","AT3","AT4","AT5",
"ARP1","ARP2","ARP3","ARP4","ARP5",
"ODP3"),
color = "#FB8072",active = T),
list(
query = intersects,
params = list("AT1","AT2","AT3","AT4","AT5",
"ARP1","ARP2","ARP3","ARP4","ARP5",
"ODP4","ODP5"),
color = "#FB8072",active = T),
list(
query = intersects,
params = list("AT2",
"ARP1"),
color = "#FB8072",active = T),
list(
query = intersects,
params = list("AT4",
"ARP5"),
color = "#FB8072",active = T),
list(
query = intersects,
params = list("AT1","AT2","AT3","AT4","AT5",
"ARP1","ARP2","ARP3","ARP5",
"ODP5"),
color = "#FB8072",active = T),
list(
query = intersects,
params = list("AT1","AT2","AT3","AT4","AT5",
"ARP1","ARP2","ARP3","ARP4","ARP5",
"ODP1"),
color = "#FB8072",active = T),
list(
query = intersects,
params = list("AT1","AT2","AT3","AT4","AT5",
"ARP1","ARP2","ARP3","ARP4","ARP5",
"ODP2"),
color = "#FB8072",active = T),
list(
query = intersects,
params = list("AT1","AT2","AT3","AT4","AT5",
"ARP1","ARP2","ARP3","ARP4","ARP5",
"ODP5"),
color = "#FB8072",active = T)
)
)
dev.off()
upset(fromList(arg_subtype),
nsets = 15,
nintersects = 52,
order.by = "freq",
mb.ratio = c(0.6,0.4),   # 左侧和上方条形图的比例关系
text.scale = 1.5,
mainbar.y.label = "Intersection ARG subtype numbers",
sets.x.label = "ARG subtype numbers",
main.bar.color = "#f4cccc", matrix.color = "#A6CEE3",
sets.bar.color = "#A6CEE3",
shade.color = "#A6CEE3",
shade.alpha = 0.25, matrix.dot.alpha = 0.5,
queries = list(
list(
query = intersects,
params = list("AT1","AT2","AT3","AT4","AT5",
"ARP1","ARP2","ARP3","ARP4","ARP5",
"ODP1","ODP2","ODP3","ODP4","ODP5"),
color = "#FB8072",active = T),
list(
query = intersects,
params = list("AT1","AT2","AT3","AT4","AT5",
"ARP1","ARP2","ARP3","ARP4","ARP5"),
color = "#FB8072",active = T),
list(
query = intersects,
params = list("AT1","AT2","AT3","AT4","AT5",
"ARP1","ARP2","ARP3","ARP4","ARP5",
"ODP1","ODP2","ODP4","ODP5"),
color = "#FB8072",active = T),
list(
query = intersects,
params = list("AT1","AT2","AT3","AT4","AT5",
"ARP1","ARP2","ARP3","ARP4","ARP5",
"ODP2","ODP3","ODP4","ODP5"),
color = "#FB8072",active = T),
list(
query = intersects,
params = list("AT1","AT2","AT3","AT4","AT5",
"ARP1","ARP2","ARP3","ARP4","ARP5",
"ODP4"),
color = "#FB8072",active = T),
list(
query = intersects,
params = list("AT1","AT2","AT3","AT4","AT5",
"ARP1","ARP2","ARP3","ARP4","ARP5",
"ODP1","ODP3","ODP4","ODP5"),
color = "#FB8072",active = T),
list(
query = intersects,
params = list("AT1","AT2","AT3","AT4","AT5",
"ARP1","ARP2","ARP3","ARP4"),
color = "#FB8072",active = T),
list(
query = intersects,
params = list("AT1","AT2","AT3","AT4","AT5",
"ARP3","ARP4","ARP5"),
color = "#FB8072",active = T),
list(
query = intersects,
params = list("AT1","AT2","AT3","AT4","AT5",
"ARP1","ARP2","ARP3","ARP4","ARP5",
"ODP2","ODP5"),
color = "#FB8072",active = T),
list(
query = intersects,
params = list("AT1","AT2","AT3","AT4","AT5",
"ARP1","ARP2","ARP3","ARP4","ARP5",
"ODP2","ODP3","ODP4"),
color = "#FB8072",active = T),
list(
query = intersects,
params = list("AT1","AT2","AT3","AT4","AT5",
"ARP1","ARP3","ARP4","ARP5"),
color = "#FB8072",active = T),
list(
query = intersects,
params = list("AT1","AT2","AT3","AT4","AT5",
"ARP1","ARP2","ARP3","ARP4","ARP5",
"ODP3"),
color = "#FB8072",active = T),
list(
query = intersects,
params = list("AT1","AT2","AT3","AT4","AT5",
"ARP1","ARP2","ARP3","ARP4","ARP5",
"ODP4","ODP5"),
color = "#FB8072",active = T),
list(
query = intersects,
params = list("AT2",
"ARP1"),
color = "#FB8072",active = T),
list(
query = intersects,
params = list("AT4",
"ARP5"),
color = "#FB8072",active = T),
list(
query = intersects,
params = list("AT1","AT2","AT3","AT4","AT5",
"ARP1","ARP2","ARP3","ARP5",
"ODP5"),
color = "#FB8072",active = T),
list(
query = intersects,
params = list("AT1","AT2","AT3","AT4","AT5",
"ARP1","ARP2","ARP3","ARP4","ARP5",
"ODP1"),
color = "#FB8072",active = T),
list(
query = intersects,
params = list("AT1","AT2","AT3","AT4","AT5",
"ARP1","ARP2","ARP3","ARP4","ARP5",
"ODP2"),
color = "#FB8072",active = T),
list(
query = intersects,
params = list("AT1","AT2","AT3","AT4","AT5",
"ARP1","ARP2","ARP3","ARP4","ARP5",
"ODP5"),
color = "#FB8072",active = T)
)
)
# Plot
## Save
pdf(file= "../../airborne_arg_uwtp_result/Figure/ARG/ARG_upset.pdf",
width = 9,
height = 7)
upset(fromList(arg_subtype),
nsets = 15,
nintersects = 52,
order.by = "freq",
mb.ratio = c(0.6,0.4),   # 左侧和上方条形图的比例关系
text.scale = 1.5,
mainbar.y.label = "Intersection ARG subtype numbers",
sets.x.label = "ARG subtype numbers",
main.bar.color = "#f4cccc", matrix.color = "#A6CEE3",
sets.bar.color = "#A6CEE3",
shade.color = "#A6CEE3",
shade.alpha = 0.25, matrix.dot.alpha = 0.5,
queries = list(
list(
query = intersects,
params = list("AT1","AT2","AT3","AT4","AT5",
"ARP1","ARP2","ARP3","ARP4","ARP5",
"ODP1","ODP2","ODP3","ODP4","ODP5"),
color = "#FB8072",active = T),
list(
query = intersects,
params = list("AT1","AT2","AT3","AT4","AT5",
"ARP1","ARP2","ARP3","ARP4","ARP5"),
color = "#FB8072",active = T),
list(
query = intersects,
params = list("AT1","AT2","AT3","AT4","AT5",
"ARP1","ARP2","ARP3","ARP4","ARP5",
"ODP1","ODP2","ODP4","ODP5"),
color = "#FB8072",active = T),
list(
query = intersects,
params = list("AT1","AT2","AT3","AT4","AT5",
"ARP1","ARP2","ARP3","ARP4","ARP5",
"ODP2","ODP3","ODP4","ODP5"),
color = "#FB8072",active = T),
list(
query = intersects,
params = list("AT1","AT2","AT3","AT4","AT5",
"ARP1","ARP2","ARP3","ARP4","ARP5",
"ODP4"),
color = "#FB8072",active = T),
list(
query = intersects,
params = list("AT1","AT2","AT3","AT4","AT5",
"ARP1","ARP2","ARP3","ARP4","ARP5",
"ODP1","ODP3","ODP4","ODP5"),
color = "#FB8072",active = T),
list(
query = intersects,
params = list("AT1","AT2","AT3","AT4","AT5",
"ARP1","ARP2","ARP3","ARP4"),
color = "#FB8072",active = T),
list(
query = intersects,
params = list("AT1","AT2","AT3","AT4","AT5",
"ARP3","ARP4","ARP5"),
color = "#FB8072",active = T),
list(
query = intersects,
params = list("AT1","AT2","AT3","AT4","AT5",
"ARP1","ARP2","ARP3","ARP4","ARP5",
"ODP2","ODP5"),
color = "#FB8072",active = T),
list(
query = intersects,
params = list("AT1","AT2","AT3","AT4","AT5",
"ARP1","ARP2","ARP3","ARP4","ARP5",
"ODP2","ODP3","ODP4"),
color = "#FB8072",active = T),
list(
query = intersects,
params = list("AT1","AT2","AT3","AT4","AT5",
"ARP1","ARP3","ARP4","ARP5"),
color = "#FB8072",active = T),
list(
query = intersects,
params = list("AT1","AT2","AT3","AT4","AT5",
"ARP1","ARP2","ARP3","ARP4","ARP5",
"ODP3"),
color = "#FB8072",active = T),
list(
query = intersects,
params = list("AT1","AT2","AT3","AT4","AT5",
"ARP1","ARP2","ARP3","ARP4","ARP5",
"ODP4","ODP5"),
color = "#FB8072",active = T),
list(
query = intersects,
params = list("AT2",
"ARP1"),
color = "#FB8072",active = T),
list(
query = intersects,
params = list("AT4",
"ARP5"),
color = "#FB8072",active = T),
list(
query = intersects,
params = list("AT1","AT2","AT3","AT4","AT5",
"ARP1","ARP2","ARP3","ARP5",
"ODP5"),
color = "#FB8072",active = T),
list(
query = intersects,
params = list("AT1","AT2","AT3","AT4","AT5",
"ARP1","ARP2","ARP3","ARP4","ARP5",
"ODP1"),
color = "#FB8072",active = T),
list(
query = intersects,
params = list("AT1","AT2","AT3","AT4","AT5",
"ARP1","ARP2","ARP3","ARP4","ARP5",
"ODP2"),
color = "#FB8072",active = T),
list(
query = intersects,
params = list("AT1","AT2","AT3","AT4","AT5",
"ARP1","ARP2","ARP3","ARP4","ARP5",
"ODP5"),
color = "#FB8072",active = T)
)
)
dev.off()
dev.off()
